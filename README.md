# iconik API client

This copy (in https://github.com/imtlab/iconik) is substantially edited version of code generated by Swagger Codegen.&#160;
The original code as generated by Swagger Codegen can be found at https://github.com/toddyvega/iconik.

As is common with auto-generated code, the original code contains many [redundancies](#redundancies),
[inefficiencies](#inefficiencies), and [things that plain don’t work](#things-that-plain-dont-work),
all of which I have corrected in this code.

## Redundancies
Each package repeats the exact code in files `client.go`, `configuration.go`, `response.go`.&#160;
A new package `github.com/imtlab/iconik/shared` has been created to encapsulate just one incarnation of these files.

Also, each method of each package’s `api_default.go` contains the same chunk of boilerplate code that effectively does nothing.&#160;
This has been removed from this **imtlab** code.&#160;
If it _had_ done anything, I would have encapsulated it in its own function rather than letting the same code be repeated in every method.

## Inefficiencies
The `appID` and `authToken` is passed as a parameter to each method of each package’s `api_default.go`.&#160;
This is pointlessly verbose as there’ll only ever be one set of `appID` and `authToken`.&#160;
In this **imtlab** code, `appID` and `authToken` are set on the `shared.APIClient`’s `cfg.DefaultHeader`
and automatically added to each request header in that client’s prepareRequest() method.

## Things that plain don’t work
Any `json.Unmarshal()` to a struct containing a `time.Time` member fails because iconik formats its dates as
"2006-01-02T15:04:05.999999" (UTC assumed), whereas Go’s default UnmarshalJSON() for time.Time expects format
`time.RFC3339` ("2006-01-02T15:04:05Z07:00").&#160;
So it was necessary to:

1. Create, in package `github.com/imtlab/iconik/shared`, a custom type `Time` with underlying type `time.Time`,
and implement the json.Unmarshaler interface for that custom type using iconik’s format.
1. Change every `time.Time` member of every struct in every package to `shared.Time`.
